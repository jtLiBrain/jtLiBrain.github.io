<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1472px" height="1142px" viewBox="-0.5 -0.5 1472 1142" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-09-02T10:00:14.037Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;qrut1L6StlLk-ODo_Avs&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Ke9E5-MahDyhlt_UqyjE&quot; name=&quot;第 1 页&quot;&gt;7V1rk6I6Gv41fGyLcE0+gtq7U3WmzuzpPTV7Pm2hRmUbxUV6unt//eZCEJKAqGDbzkxNzUAISXjz5L0nGvZ48/a3LNqtv6YLnBiWuXgz7IlhWRYwAfmPlrzzEs/zeMEqixe8CBwKnuL/4aLQLEpf4gXe1yrmaZrk8a5eOE+3WzzPa2VRlqWv9WrLNKn3uotWWCl4mkeJWvo9XuTrohR46PDg7zherUXXnuvwJ7No/rzK0pdt0aFh2Uv2hz/eRKKx4kv362iRvlaK7Klhj7M0zfnV5m2ME0pcQTf+3mPD03LgGd7mXV748u9/uN//+vPr5M9ovXkLUt+Jpw8Wb+VHlLwUBDHs4CnN8qf1y3KZ4O9ZnOOs+ID8XVCNfMuOXr5skt/iJU7iLbkLdziLN5jWtydJUfztUBa+rkljT7toTl99JXgiZet8k5A7QC7JFOcReSUr75Mk2u3jGevVJCUZnr9k+/gH/gPvOZJoafqS057GJUJo4TJOknGapBkbsL2IMFzOSfk+z9JnXHnizSGeLcmTghI4y/FbI4lBOXFkReCUfFn2Tqq81UH9Xr99rQKrKFtXMQWcojQq0Lwqmz5MKLko5vSE+XXU+ZXnsjIDuzTe5mwIbmi4E2lKCSrW6SrdRkl1UjuRrRl7jbR067R0NbTUkdKEQ5ESup+Xlq6ES9iNmvZgtPQUWgI4MqaOEUIjDIwpNIJHI3D3nAsxdrpjj0P6d+oaMDACwC6ggVgJfRR8jXZPeZS/7GkJaSJEtK0Q0MryZOEFkQTF7WE+pofSKnOKkni1pXwNL3PKRggXi7er39jdhJA+xNtFQOURuZ0l6fyZsisqHPCi4EhkArP3fxXNsZu/iidJNMNJWIoTwZy2KeOqfNx0sHUpGWUr3AYJgddu2CGUSV+yOT7GS1SMZTiJcsKT66JZg5ji1W90YRyw6cnY9CTQ8XEVbx1wR4gdvVeqFeutsR8k82ZPEpfH6sNafXLBR3BYBCVNzl8Xtk4cT98IdyDIpGL5LmSxi+HC0cliaM1soj/2I4u948LYvK4wvmUBYrcS06kvUgQ6iY/BCAlU8fFJKQmQ34mULrAHoqVYJp+flrCrjihLmP5oecvqdjstJXUbItiJlsgaipQqswTuiPY0YqqdZ0DLmHoGmhpozC6IBmjSCzgxginTDIkGGbDKE4N8DrkgNQPI1MjAgLwOqe9W6jAFlFxPieo4NuCYaY+mAW1j6hvIYa+rbyGqgpJC2oVJNVJamXThsPGQEVpMQQ3okGiDj6wLps0GNnsLsZZFp5aXUCVzRoS9t8rZrHvRhoro7Wy/Y/dmf0VksGSkYTn8KRs+0abF8AP2rZQMXvH1ZLz0wi0eQVjQnhCYqEnkdfJlFTIINZ7WIC36QpP3evzSWRMufCOwxNgQvSDzELAJIQOhtkZlrmQQlSjglBENUlqVDapwaGkH0eHROXeoaUJJxOBALRhIbRTeVzgRkEFFXzKIbgYp5aKScdEy5z+XHSaEwoUM2hyZ0CmUgAtNLskdAAeyuKCp7UZrQB1eFq2ny+Ue54oc6cHI0vgeqGBhy+yxWGYFa2vh1aWkKNkHpEudLnu+gN020U8FeDyPkqCA8yzN83Sjh28JWFMG7LmQ1HgGGoypC5HmyzYY6IS0vmYaquqYHXyLCOnzmCzqRbDbEXr/vk3evxIDmDK8R/JvpcK3KM5Cwsd+md1dzW5bmXJFjywZw5XMbnTDSjlsJSawJWsRdDO8B/PbWrdsLJ5GS9vsZnkPRkug0tLickhVY5HQrCF7BOgF+RcFFZOj1NAVOUTbEeo80cX4I6azN/LCixVMPq7AEy56pBOv6ihaGG7v0lNSJYfR/pAKXhGJOOZvd1vx/GCOkOf7vSiEtuyEl5tokNPX1NqApRPm/4z2z1/xJs0IarfR6h7kNAG/N9eGqhc+mplmP3IamkflNLB1Dh93MH6oCX7cjGzh6GukphRrsD5atji3rPOcRkvP1yDzqnJaderaXE4jKt+QVwg0LoOJ0EOAyTry1K95dWQ3EXMohnYR7A79wqaEXAOYMumOqOeEOnx0rweI+a8Qc0k5wwvMdgkpidNzBaZgA+dITB4XahOZnodQLyLTk8OLQhTfkshUfegZzl+y7aVQSYmqSEoW0X7N3Grckyay+yC9e4vzEkPkmkFoRHTRflB0HAnNKDqOwAYU9YwYy5VCenxggzlDgMYb8hEyoV0vkXPoLNhNlDqDBUiBKkudJjtNZellcKR0E2qDTiGNFBzc61wQTJgD0mMNtkQQVFlTjXEwp7w8z3fuchdQH97BaYG65UTUlU5i4FRfeplLIfUzaDaSIEcF+e6okljXJRCqhreag1mHgBd/iy0W8i4qw7mPwhPv6gNncmiy4ptvcuQrvou70KKEo+4sLardkUYdD5ZID7hw+TgyrNHtaVFCTFZWAc2Kj4itX3FcfSESMMrTi91Wt69atUCrI2NuiXH6APUT45SRZfvdtK2rIkub7jmJ988h5SJ349HCYOFiX+fRQp5vRz1FnpB73KOlTWEaLPBk3XLCp3VSPpjdUQ0fLvKkSa2rrJXfZ/8h8LuX3UrXWTCHbSAn+oAHjNXa/i0vmYYdEHrHpYM+2HHpqIrLZ6Wl2zG1dzBa+qop9FlpiewPpqWlJmB5I3UrV3MCITcGYcBtrTsx2Jpysi4w2C5UoSGQVehuxllv6rEqC34W93ULGs62sXpGg3Nl97WtkWZ2IPJT9rtoW8OE998XurE+XBI17YGrX6SyCcDujfzHk1QIo80fihmjD9mklW+KhJdWY5/3Tj6ID0CkyHx2BfQ6uYKebGQAjZHhakSThwbTP296B4/VSk4589J3P1bO26cldJwirPtgwudI2srBHbUZqJBY2FSX+q8saW04p3pGmxaZyIO8Ft9WnSBwVNtPRJMUmUMeoiLmJecvKo79U7m+1cL15wQF1Gkg8/0G30I3jv85lVDB/c5ZGs7RdEXbEWmGlwbdrHrQzYHWiWtjeN+urUbbURX2KsiLWNUzfmfBKcuAY/4yt4ygSKUNwkrojBtNPM48ZrlINk0ggvxojKkB2aatcExzhaqbtuRAmWpjeUbo0nbuBNn++ci2281rmlXkCtF2IbJB6W8rnUi3B21HlevAHNU5uQQvbUo63yMJjXBK/4pMCcJWs+dRYfyP9juimI5mUT5fM/OsGitmUehXzpa1SRA03dwstvsG95IfJ7x6w/Bor4yTCc/bIBzbPVmbuQKsVdX/MU7wE15tcDGqu/Y5tADrOCjbgUVwBcS5gH0jyXdH3RTaq2LpRiJ/x3LtJD1KrP1jB2hYfvO0XRayUF3D/kifvXM89UhNNKqeb3A0L0iarjtPmXNuz/9sSSawZw6VWyctA6eWW3e8frFsBs3Fc24kMHoaR/Gcj46BqmYYANUcRiVVVmMKFSmHT1QXxQuqFOiyD0sdF9LNGMFPd86F02RifV7GIPcjn7B7hDGcXN+5whGDwh1YXRHWSOw0Chj+HWGQSTK2mqhbOQ2oVqc8vYavEFicBoTQEzXsOu2MuhND7YKtv0PF8KSkSK+jGdYb9jRqsR18IUzrrThvmjlc/8D7NPnxK5GrcyKXJXmNdIlcvk6RH/Csy1s+otFtN1eltDj/oxO5/FsOSp5GS2B+tEboqoo0sDXpR7pj3FTVkHkvC5+nX5xcHfpso4pLH8F7cTuK9XyW23EQYQbkPVEQXFmaqbYFsw0unPDb9xS2YOG4VnQlLKDrZid5an4ocKrxPvXYSV1aI4v6tZ5Lqj3otIy28K2m5TEC/C3WVwhYXx4tD8PuhzN+Tm4lUl575FaHGAl0xZbgS1ErHUnV9SDGa3qyfUsFtlcel1iegFrGp8cE218mJZZZNBtRSy8MdDs+maWJGK6DsfhFh86x6UM7HhW58LECeXlQmoCgdqHIffksLYUtHerfucKpjldZIX6TldFhhXgDMXHTl5l4t/XQG9bVwPbPknDcAoeOB9wODwckQojXkukq6/tZ4NAiPz9Kw5NkJbKvCwZfdV0Bv6PZyE5n4rofEVdIJ9LuRKhckj94HSYCTNmzMLSVqDpv6FH1atyJ+cspJnwafoatuwges2iDj7s2hY8FsNzX0r1iazyVYBYBbOk8labpTYlyxZNqa+cUsh87FG+IX0+0+vFpPsjzpnPC2bof8HGH82mqJwHNR/UTWMV5/RpjTzHbGo09XeWi5YHYzenQGhI+Yorpb3DJsB0AWr6ngZaj2/hsD7bvxFV1jegQps7wPM0WjbGzWmb8L6ZRmVl1Yn1LM69nTCu5Pfx0K5cVhx/Itaf/Bw==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="81" y="0" width="110" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><path d="M 136 40 L 136 1140" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 20px; margin-left: 82px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:SortShuffleWriter</div></div></div></foreignObject><text x="136" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:SortShuffleWriter</text></switch></g><rect x="131" y="50" width="10" height="1080" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="136" y="1080" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 141 1060 L 171 1060 L 171 1080 L 154.12 1080" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 147.12 1080 L 154.12 1076.5 L 154.12 1083.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1068px; margin-left: 175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">18.为该shuffle map任务创建MapStatus对象</div></div></div></foreignObject><text x="175" y="1071" fill="#000000" font-family="Helvetica" font-size="11px">18.为该shuffle map任务创建MapStatus对象</text></switch></g><rect x="231" y="0" width="100" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 281 40 L 281 1140" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 20px; margin-left: 232px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:ExternalSorter</div></div></div></foreignObject><text x="281" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:ExternalSorter</text></switch></g><rect x="276" y="91" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="276" y="197" width="10" height="513" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="276" y="850" width="10" height="160" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="281" y="898" width="10" height="92" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 860 L 311 860 L 311 898 L 299.12 898" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 292.12 898 L 299.12 894.5 L 299.12 901.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 880px; margin-left: 315px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">15. a.如果数据只存在于内存中，调用内存集合的排序迭代器，<br />         然后直接将写入到最终的shuffle文件<br />      b.如果既有溢出的数据，同时有内存数据，那么进行归并排序，<br />         然后在写入shuffle文件</div></div></div></foreignObject><text x="315" y="883" fill="#000000" font-family="Helvetica" font-size="11px">15. a.如果数据只存在于内存中，调用内存集合的排序迭代器，...</text></switch></g><path d="M 141 91 L 267.88 91" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 274.88 91 L 267.88 94.5 L 267.88 87.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 88px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">1. 插入迭代器中的记录</div></div></div></foreignObject><text x="209" y="88" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">1. 插入迭代器中的记录</text></switch></g><rect x="441" y="0" width="280" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 581 40 L 581 1140" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 20px; margin-left: 442px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:PartitionedAppendOnlyMap / PartitionedPairBuffer</div></div></div></foreignObject><text x="581" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:PartitionedAppendOnlyMap / PartitionedPairBuf...</text></switch></g><rect x="576" y="111" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="576" y="307" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 111 L 567.88 111" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 574.88 111 L 567.88 114.5 L 567.88 107.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 108px; margin-left: 293px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">2. 如果需要聚合将记录更新到PartitionedAppendOnlyMap，<br />    否则插入到PartitionedPairBuffer</div></div></div></foreignObject><text x="293" y="108" fill="#000000" font-family="Helvetica" font-size="11px">2. 如果需要聚合将记录更新到PartitionedAppendOnlyMap，...</text></switch></g><rect x="871" y="0" width="130" height="40" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><path d="M 936 40 L 936 950" fill="none" stroke="#d79b00" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 20px; margin-left: 872px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:TaskMemoryManager</div></div></div></foreignObject><text x="936" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:TaskMemoryManager</text></switch></g><rect x="931" y="207" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="931" y="670" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 207 L 922.88 207" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 929.88 207 L 922.88 210.5 L 922.88 203.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 204px; margin-left: 394px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">3. 首先向执行内存申请一定量内存空间</div></div></div></foreignObject><text x="394" y="204" fill="#000000" font-family="Helvetica" font-size="11px">3. 首先向执行内存申请一定量内存空间</text></switch></g><path d="M 931 235.5 L 288.24 235.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 296.12 231 L 287.12 235.5 L 296.12 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 233px; margin-left: 610px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="610" y="233" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><rect x="281" y="277" width="10" height="413" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 257 L 311 257 L 311 277 L 299.12 277" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 292.12 277 L 299.12 273.5 L 299.12 280.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 265px; margin-left: 315px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">4. 如果申请到的内存仍然不足，那么执行溢写</div></div></div></foreignObject><text x="315" y="268" fill="#000000" font-family="Helvetica" font-size="11px">4. 如果申请到的内存仍然不足，那么执行溢写</text></switch></g><path d="M 291 307 L 567.88 307" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 574.88 307 L 567.88 310.5 L 567.88 303.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 304px; margin-left: 303px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">5.对内存集合进行排序，并返回可以进行写入的迭代器 </div></div></div></foreignObject><text x="303" y="304" fill="#000000" font-family="Helvetica" font-size="11px">5.对内存集合进行排序，并返回可以进行写入的迭代器 </text></switch></g><path d="M 576 335.5 L 293.24 335.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 331 L 292.12 335.5 L 301.12 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 333px; margin-left: 333px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">WritablePartitionedIterator</div></div></div></foreignObject><text x="333" y="333" fill="#000000" font-family="Helvetica" font-size="11px">WritablePartitionedIterator</text></switch></g><rect x="1021" y="0" width="110" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1076 40 L 1076 940" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 20px; margin-left: 1022px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:DiskBlockManager</div></div></div></foreignObject><text x="1076" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:DiskBlockManager</text></switch></g><rect x="1071" y="387" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1151" y="0" width="130" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1216 40 L 1216 1140" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 20px; margin-left: 1152px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:DiskBlockObjectWriter</div></div></div></foreignObject><text x="1216" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:DiskBlockObjectWriter</text></switch></g><rect x="1211" y="490" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1211" y="550" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1211" y="930" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 387 L 1062.88 387" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1069.88 387 L 1062.88 390.5 L 1062.88 383.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 384px; margin-left: 683px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">6.创建shuffle文件及block</div></div></div></foreignObject><text x="683" y="384" fill="#000000" font-family="Helvetica" font-size="11px">6.创建shuffle文件及block</text></switch></g><path d="M 1071 415.5 L 293.24 415.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 411 L 292.12 415.5 L 301.12 420" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 413px; margin-left: 683px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="683" y="413" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><rect x="721" y="307" width="150" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 796 347 L 796 997" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 327px; margin-left: 722px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:<span style="font-size: 11px ; text-align: left">WritablePartitionedIterator</span></div></div></div></foreignObject><text x="796" y="331" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:WritablePartitionedItera...</text></switch></g><rect x="791" y="482" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 586 325 L 712.88 325" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 719.88 325 L 712.88 328.5 L 712.88 321.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 296 482 L 782.88 482" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 789.88 482 L 782.88 485.5 L 782.88 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 479px; margin-left: 460px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">8.将当前记录写入<span style="font-size: 12px ; text-align: center">DiskBlockObjectWriter</span></div></div></div></foreignObject><text x="460" y="479" fill="#000000" font-family="Helvetica" font-size="11px">8.将当前记录写入DiskBlockObjectWriter</text></switch></g><path d="M 801 490 L 1202.88 490" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 490 L 1202.88 493.5 L 1202.88 486.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 487px; margin-left: 874px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">9.将记录的key和value分别序列化、压缩后写入文件流</div></div></div></foreignObject><text x="874" y="487" fill="#000000" font-family="Helvetica" font-size="11px">9.将记录的key和value分别序列化、压缩后写入文件流</text></switch></g><path d="M 296 550 L 1202.88 550" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 550 L 1202.88 553.5 L 1202.88 546.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 542px; margin-left: 464px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">10.当写入记录数达到spark.shuffle.spill.batchSize，对writer执行提交</div></div></div></foreignObject><text x="464" y="542" fill="#000000" font-family="Helvetica" font-size="11px">10.当写入记录数达到spark.shuffle.spill.batchSize，对writer执行提交</text></switch></g><path d="M 1211 578.5 L 298.24 578.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 306.12 574 L 297.12 578.5 L 306.12 583" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 576px; margin-left: 473px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">FileSegment</div></div></div></foreignObject><text x="473" y="576" fill="#000000" font-family="Helvetica" font-size="11px">FileSegment</text></switch></g><rect x="286" y="463" width="10" height="127" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 437 L 316 437 L 316 463 L 304.12 463" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 297.12 463 L 304.12 459.5 L 304.12 466.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 448px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">7.迭代内存集合排序后的迭代器</div></div></div></foreignObject><text x="320" y="451" fill="#000000" font-family="Helvetica" font-size="11px">7.迭代内存集合排序后的迭代器</text></switch></g><rect x="286" y="630" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 597 L 291 610 L 316 610 L 316 630 L 304.12 630" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 297.12 630 L 304.12 626.5 L 304.12 633.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 611px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">11.对溢写文件以SpilledFile进行记账</div></div></div></foreignObject><text x="320" y="614" fill="#000000" font-family="Helvetica" font-size="11px">11.对溢写文件以SpilledFile进行记账</text></switch></g><path d="M 291 670 L 922.88 670" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 929.88 670 L 922.88 673.5 L 922.88 666.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 667px; margin-left: 613px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">12.释放内存，将内存归还给Spark执行内存</div></div></div></foreignObject><text x="613" y="667" fill="#000000" font-family="Helvetica" font-size="11px">12.释放内存，将内存归还给Spark执行内存</text></switch></g><rect x="1301" y="0" width="170" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1386 40 L 1386 1140" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 20px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:IndexShuffleBlockResolver</div></div></div></foreignObject><text x="1386" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:IndexShuffleBlockResolver</text></switch></g><rect x="1381" y="790" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1381" y="1040" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 141 790 L 1372.88 790" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1379.88 790 L 1372.88 793.5 L 1372.88 786.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 787px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">13.创建数据文件输出路径</div></div></div></foreignObject><text x="763" y="787" fill="#000000" font-family="Helvetica" font-size="11px">13.创建数据文件输出路径</text></switch></g><path d="M 1381 818.5 L 143.24 818.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 151.12 814 L 142.12 818.5 L 151.12 823" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 816px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">File</div></div></div></foreignObject><text x="763" y="816" fill="#000000" font-family="Helvetica" font-size="11px">File</text></switch></g><path d="M 141 850 L 267.88 850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 274.88 850 L 267.88 853.5 L 267.88 846.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 847px; margin-left: 153px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">14.将溢出文件和内存中数据写到一个汇总shuffle文件</div></div></div></foreignObject><text x="153" y="847" fill="#000000" font-family="Helvetica" font-size="11px">14.将溢出文件和内存中数据写到一个汇总shuffle文件</text></switch></g><path d="M 291 930 L 1202.88 930" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 930 L 1202.88 933.5 L 1202.88 926.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 927px; margin-left: 753px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">16. 按分区ID和key顺序，依次写入文件流，每个分区提交一个文件片段</div></div></div></foreignObject><text x="753" y="927" fill="#000000" font-family="Helvetica" font-size="11px">16. 按分区ID和key顺序，依次写入文件流，每个分区提交一个文件片段</text></switch></g><path d="M 1211 958.5 L 293.24 958.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 954 L 292.12 958.5 L 301.12 963" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 956px; margin-left: 753px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="753" y="956" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><path d="M 276 1002 L 143.24 1002" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 151.12 997.5 L 142.12 1002 L 151.12 1006.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 999px; margin-left: 210px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="210" y="999" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><path d="M 141 1040 L 1372.88 1040" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1379.88 1040 L 1372.88 1043.5 L 1372.88 1036.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1037px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">17.创建数据索引文件</div></div></div></foreignObject><text x="763" y="1037" fill="#000000" font-family="Helvetica" font-size="11px">17.创建数据索引文件</text></switch></g><path d="M 1 180 L 121 180 L 121 195 L 111 210 L 1 210 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 121 180 L 1301 180 L 1301 720 L 1 720 L 1 210" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 195px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">b.溢写过程</div></div></div></foreignObject><text x="61" y="199" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">b.溢写过程</text></switch></g><path d="M 1 750 L 291 750 L 291 765 L 281 780 L 1 780 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 291 750 L 1431 750 L 1431 1140 L 1 1140 L 1 780" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 288px; height: 1px; padding-top: 765px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">c.合并溢出数据和内存数据并创建数据索引文件</div></div></div></foreignObject><text x="146" y="769" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">c.合并溢出数据和内存数据并创建数据索引文件</text></switch></g><path d="M 1 60 L 121 60 L 121 75 L 111 90 L 1 90 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 121 60 L 721 60 L 721 150 L 1 150 L 1 90" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 75px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">a.对record执行写入</div></div></div></foreignObject><text x="61" y="79" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">a.对record执行写入</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>