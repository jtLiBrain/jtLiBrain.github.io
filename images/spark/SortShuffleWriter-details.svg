<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1472px" height="1142px" viewBox="-0.5 -0.5 1472 1142" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-09-03T03:48:00.203Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;8_Rvk9qK4FsToA-1zUdl&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Ke9E5-MahDyhlt_UqyjE&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="81" y="0" width="110" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><path d="M 136 40 L 136 1140" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 20px; margin-left: 82px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:SortShuffleWriter</div></div></div></foreignObject><text x="136" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:SortShuffleWriter</text></switch></g><rect x="131" y="50" width="10" height="1080" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="136" y="1080" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 141 1060 L 171 1060 L 171 1080 L 154.12 1080" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 147.12 1080 L 154.12 1076.5 L 154.12 1083.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1068px; margin-left: 175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">18.为该shuffle map任务创建MapStatus对象</div></div></div></foreignObject><text x="175" y="1071" fill="#000000" font-family="Helvetica" font-size="11px">18.为该shuffle map任务创建MapStatus对象</text></switch></g><rect x="231" y="0" width="100" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 281 40 L 281 1140" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 20px; margin-left: 232px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:ExternalSorter</div></div></div></foreignObject><text x="281" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:ExternalSorter</text></switch></g><rect x="276" y="91" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="276" y="197" width="10" height="513" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="276" y="850" width="10" height="160" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="281" y="898" width="10" height="92" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 860 L 311 860 L 311 898 L 299.12 898" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 292.12 898 L 299.12 894.5 L 299.12 901.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 880px; margin-left: 315px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">15. a.如果数据只存在于内存中，调用内存集合的排序迭代器，<br />         然后直接将写入到最终的shuffle文件<br />      b.如果既有溢出的数据，同时有内存数据，那么进行归并排序，<br />         然后在写入shuffle文件</div></div></div></foreignObject><text x="315" y="883" fill="#000000" font-family="Helvetica" font-size="11px">15. a.如果数据只存在于内存中，调用内存集合的排序迭代器，...</text></switch></g><path d="M 141 91 L 267.88 91" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 274.88 91 L 267.88 94.5 L 267.88 87.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 88px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">1. 插入迭代器中的记录</div></div></div></foreignObject><text x="209" y="88" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">1. 插入迭代器中的记录</text></switch></g><rect x="441" y="0" width="280" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 581 40 L 581 1140" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 20px; margin-left: 442px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:PartitionedAppendOnlyMap / PartitionedPairBuffer</div></div></div></foreignObject><text x="581" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:PartitionedAppendOnlyMap / PartitionedPairBuf...</text></switch></g><rect x="576" y="111" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="576" y="307" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 111 L 567.88 111" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 574.88 111 L 567.88 114.5 L 567.88 107.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 108px; margin-left: 293px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">2. 如果需要聚合将记录更新到PartitionedAppendOnlyMap，<br />    否则插入到PartitionedPairBuffer</div></div></div></foreignObject><text x="293" y="108" fill="#000000" font-family="Helvetica" font-size="11px">2. 如果需要聚合将记录更新到PartitionedAppendOnlyMap，...</text></switch></g><rect x="871" y="0" width="130" height="40" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><path d="M 936 40 L 936 950" fill="none" stroke="#d79b00" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 20px; margin-left: 872px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:TaskMemoryManager</div></div></div></foreignObject><text x="936" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:TaskMemoryManager</text></switch></g><rect x="931" y="207" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="931" y="670" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 207 L 922.88 207" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 929.88 207 L 922.88 210.5 L 922.88 203.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 204px; margin-left: 394px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">3. 首先向执行内存申请一定量内存空间</div></div></div></foreignObject><text x="394" y="204" fill="#000000" font-family="Helvetica" font-size="11px">3. 首先向执行内存申请一定量内存空间</text></switch></g><path d="M 931 235.5 L 288.24 235.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 296.12 231 L 287.12 235.5 L 296.12 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 233px; margin-left: 610px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="610" y="233" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><rect x="281" y="277" width="10" height="413" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 286 257 L 311 257 L 311 277 L 299.12 277" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 292.12 277 L 299.12 273.5 L 299.12 280.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 265px; margin-left: 315px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">4. 如果申请到的内存仍然不足，那么执行溢出</div></div></div></foreignObject><text x="315" y="268" fill="#000000" font-family="Helvetica" font-size="11px">4. 如果申请到的内存仍然不足，那么执行溢出</text></switch></g><path d="M 291 307 L 567.88 307" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 574.88 307 L 567.88 310.5 L 567.88 303.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 304px; margin-left: 303px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">5.对内存集合进行排序，并返回可以进行写入的迭代器 </div></div></div></foreignObject><text x="303" y="304" fill="#000000" font-family="Helvetica" font-size="11px">5.对内存集合进行排序，并返回可以进行写入的迭代器 </text></switch></g><path d="M 576 335.5 L 293.24 335.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 331 L 292.12 335.5 L 301.12 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 333px; margin-left: 333px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">WritablePartitionedIterator</div></div></div></foreignObject><text x="333" y="333" fill="#000000" font-family="Helvetica" font-size="11px">WritablePartitionedIterator</text></switch></g><rect x="1021" y="0" width="110" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1076 40 L 1076 940" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 20px; margin-left: 1022px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:DiskBlockManager</div></div></div></foreignObject><text x="1076" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:DiskBlockManager</text></switch></g><rect x="1071" y="387" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1151" y="0" width="130" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1216 40 L 1216 1140" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 20px; margin-left: 1152px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:DiskBlockObjectWriter</div></div></div></foreignObject><text x="1216" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:DiskBlockObjectWriter</text></switch></g><rect x="1211" y="490" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1211" y="550" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1211" y="930" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 387 L 1062.88 387" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1069.88 387 L 1062.88 390.5 L 1062.88 383.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 384px; margin-left: 683px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">6.创建shuffle文件及block</div></div></div></foreignObject><text x="683" y="384" fill="#000000" font-family="Helvetica" font-size="11px">6.创建shuffle文件及block</text></switch></g><path d="M 1071 415.5 L 293.24 415.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 411 L 292.12 415.5 L 301.12 420" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 413px; margin-left: 683px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="683" y="413" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><rect x="721" y="307" width="150" height="40" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><path d="M 796 347 L 796 997" fill="none" stroke="#82b366" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 327px; margin-left: 722px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:<span style="font-size: 11px ; text-align: left">WritablePartitionedIterator</span></div></div></div></foreignObject><text x="796" y="331" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:WritablePartitionedItera...</text></switch></g><rect x="791" y="482" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 586 325 L 712.88 325" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 719.88 325 L 712.88 328.5 L 712.88 321.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 296 482 L 782.88 482" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 789.88 482 L 782.88 485.5 L 782.88 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 479px; margin-left: 460px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">8.将当前记录写入<span style="font-size: 12px ; text-align: center">DiskBlockObjectWriter</span></div></div></div></foreignObject><text x="460" y="479" fill="#000000" font-family="Helvetica" font-size="11px">8.将当前记录写入DiskBlockObjectWriter</text></switch></g><path d="M 801 490 L 1202.88 490" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 490 L 1202.88 493.5 L 1202.88 486.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 487px; margin-left: 874px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">9.将记录的key和value分别序列化、压缩后写入文件流</div></div></div></foreignObject><text x="874" y="487" fill="#000000" font-family="Helvetica" font-size="11px">9.将记录的key和value分别序列化、压缩后写入文件流</text></switch></g><path d="M 296 550 L 1202.88 550" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 550 L 1202.88 553.5 L 1202.88 546.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 542px; margin-left: 464px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">10.当写入记录数达到spark.shuffle.spill.batchSize，对writer执行提交</div></div></div></foreignObject><text x="464" y="542" fill="#000000" font-family="Helvetica" font-size="11px">10.当写入记录数达到spark.shuffle.spill.batchSize，对writer执行提交</text></switch></g><path d="M 1211 578.5 L 298.24 578.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 306.12 574 L 297.12 578.5 L 306.12 583" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 576px; margin-left: 473px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">FileSegment</div></div></div></foreignObject><text x="473" y="576" fill="#000000" font-family="Helvetica" font-size="11px">FileSegment</text></switch></g><rect x="286" y="463" width="10" height="127" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 437 L 316 437 L 316 463 L 304.12 463" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 297.12 463 L 304.12 459.5 L 304.12 466.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 448px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">7.迭代内存集合排序后的迭代器</div></div></div></foreignObject><text x="320" y="451" fill="#000000" font-family="Helvetica" font-size="11px">7.迭代内存集合排序后的迭代器</text></switch></g><rect x="286" y="630" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 291 597 L 291 610 L 316 610 L 316 630 L 304.12 630" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 297.12 630 L 304.12 626.5 L 304.12 633.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 611px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">11.对溢写文件以SpilledFile进行记账</div></div></div></foreignObject><text x="320" y="614" fill="#000000" font-family="Helvetica" font-size="11px">11.对溢写文件以SpilledFile进行记账</text></switch></g><path d="M 291 670 L 922.88 670" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 929.88 670 L 922.88 673.5 L 922.88 666.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 667px; margin-left: 613px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">12.释放内存，将内存归还给Spark执行内存</div></div></div></foreignObject><text x="613" y="667" fill="#000000" font-family="Helvetica" font-size="11px">12.释放内存，将内存归还给Spark执行内存</text></switch></g><rect x="1301" y="0" width="170" height="40" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/><path d="M 1386 40 L 1386 1140" fill="none" stroke="#9673a6" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 20px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:IndexShuffleBlockResolver</div></div></div></foreignObject><text x="1386" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">:IndexShuffleBlockResolver</text></switch></g><rect x="1381" y="790" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="1381" y="1040" width="10" height="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 141 790 L 1372.88 790" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1379.88 790 L 1372.88 793.5 L 1372.88 786.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 787px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">13.创建数据文件输出路径</div></div></div></foreignObject><text x="763" y="787" fill="#000000" font-family="Helvetica" font-size="11px">13.创建数据文件输出路径</text></switch></g><path d="M 1381 818.5 L 143.24 818.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 151.12 814 L 142.12 818.5 L 151.12 823" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 816px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">File</div></div></div></foreignObject><text x="763" y="816" fill="#000000" font-family="Helvetica" font-size="11px">File</text></switch></g><path d="M 141 850 L 267.88 850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 274.88 850 L 267.88 853.5 L 267.88 846.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 847px; margin-left: 153px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">14.将溢出文件和内存中数据写到一个汇总shuffle文件</div></div></div></foreignObject><text x="153" y="847" fill="#000000" font-family="Helvetica" font-size="11px">14.将溢出文件和内存中数据写到一个汇总shuffle文件</text></switch></g><path d="M 291 930 L 1202.88 930" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1209.88 930 L 1202.88 933.5 L 1202.88 926.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 927px; margin-left: 753px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">16. 按分区ID和key顺序，依次写入文件流，每个分区提交一个文件片段</div></div></div></foreignObject><text x="753" y="927" fill="#000000" font-family="Helvetica" font-size="11px">16. 按分区ID和key顺序，依次写入文件流，每个分区提交一个文件片段</text></switch></g><path d="M 1211 958.5 L 293.24 958.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 301.12 954 L 292.12 958.5 L 301.12 963" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 956px; margin-left: 753px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="753" y="956" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><path d="M 276 1002 L 143.24 1002" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 151.12 997.5 L 142.12 1002 L 151.12 1006.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 999px; margin-left: 210px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">return</div></div></div></foreignObject><text x="210" y="999" fill="#000000" font-family="Helvetica" font-size="11px">return</text></switch></g><path d="M 141 1040 L 1372.88 1040" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1379.88 1040 L 1372.88 1043.5 L 1372.88 1036.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1037px; margin-left: 763px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">17.创建数据索引文件</div></div></div></foreignObject><text x="763" y="1037" fill="#000000" font-family="Helvetica" font-size="11px">17.创建数据索引文件</text></switch></g><path d="M 1 750 L 291 750 L 291 765 L 281 780 L 1 780 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 291 750 L 1431 750 L 1431 1140 L 1 1140 L 1 780" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 288px; height: 1px; padding-top: 765px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">c.合并溢出数据和内存数据并创建数据索引文件</div></div></div></foreignObject><text x="146" y="769" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">c.合并溢出数据和内存数据并创建数据索引文件</text></switch></g><path d="M 1 60 L 121 60 L 121 75 L 111 90 L 1 90 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 121 60 L 721 60 L 721 150 L 1 150 L 1 90" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 75px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">a.对record执行写入</div></div></div></foreignObject><text x="61" y="79" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">a.对record执行写入</text></switch></g><path d="M 1 180 L 121 180 L 121 195 L 111 210 L 1 210 Z" fill="#1ba1e2" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 121 180 L 1301 180 L 1301 720 L 1 720 L 1 210" fill="none" stroke="#006eaf" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 195px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">b.溢出过程</div></div></div></foreignObject><text x="61" y="199" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">b.溢出过程</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>